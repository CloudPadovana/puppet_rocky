# Default rule for most non-Admin APIs.
"admin_or_owner": "is_admin:True or (role:admin and is_admin_project:True) or project_id:%(project_id)s"

# Define non-standard role for the CloudVeneto platform
"admin_or_user": "is_admin:True or (role:admin and is_admin_project:True) or user_id:%(user_id)s"

# Use the newly created role as default
"default": "rule:admin_or_user"

# Decides what is required for the 'is_admin:True' check to succeed.
"context_is_admin": "role:admin"

# Default rule for most Admin APIs.
"admin_api": "is_admin:True or (role:admin and is_admin_project:True)"

# Reset status of group snapshot.
# POST  /group_snapshots/{g_snapshot_id}/action (reset_status)
"group:reset_group_snapshot_status": "rule:admin_api"

# Delete volume.
# DELETE  /volumes/{volume_id}
"volume:delete": "rule:admin_or_user"

# Delete snapshot.
# DELETE  /snapshots/{snapshot_id}
"volume:delete_snapshot": "rule:admin_or_user"

# Delete snapshot's specified metadata with a given key.
# DELETE  /snapshots/{snapshot_id}/metadata/{key}
"volume:delete_snapshot_metadata": "rule:admin_or_user"

# Delete volume's specified metadata with a given key.
# DELETE  /volumes/{volume_id}/metadata/{key}
"volume:delete_volume_metadata": "rule:admin_or_user"

# Show project quota (including usage and default).
# GET  /os-quota-sets/{project_id}
# GET  /os-quota-sets/{project_id}/default
# GET  /os-quota-sets/{project_id}?usage=True
"volume_extension:quotas:show": "rule:admin_or_owner"
